<!DOCTYPE html><html class="theme-next mist use-motion" lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet"><link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet"><link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet"><link href="/css/main.css?v=5.1.1" rel="stylesheet"><meta name="keywords" content="装机,"><link rel="alternate" href="/atom.xml" title="Lyogvce" type="application/atom+xml"><link rel="shortcut icon" type="image/x-icon" href="/favicon.png?v=5.1.1"><meta name="description" content="1 引导基础篇: 什么是 UEFI, 什么是 GPT本文目的是想用最简单直白的语言把内容写出来, 让每个人都能轻松读懂。当然, 如果你已经对这些内容有了很深的理解的话, 这篇文章除了浪费你的时间外恐怕是别无益处了, 建议去 UEFI 官方网站下载 UEFI 规范文档, 那里详细阐述了 UEFI、GPT 的每个技术细节。"><meta name="keywords" content="装机"><meta property="og:type" content="article"><meta property="og:title" content="UEFI &amp; GPT"><meta property="og:url" content="http://blog.lyogvce.me/2017-03/UEFI-And-GPT.html"><meta property="og:site_name" content="Lyogvce"><meta property="og:description" content="1 引导基础篇: 什么是 UEFI, 什么是 GPT本文目的是想用最简单直白的语言把内容写出来, 让每个人都能轻松读懂。当然, 如果你已经对这些内容有了很深的理解的话, 这篇文章除了浪费你的时间外恐怕是别无益处了, 建议去 UEFI 官方网站下载 UEFI 规范文档, 那里详细阐述了 UEFI、GPT 的每个技术细节。"><meta property="og:image" content="http://blog.lyogvce.me/images/UEFI-And-GPT/MBR.jpg"><meta property="og:image" content="http://blog.lyogvce.me/images/UEFI-And-GPT/gpt.jpg"><meta property="og:image" content="http://blog.lyogvce.me/images/UEFI-And-GPT/1.jpg"><meta property="og:image" content="http://blog.lyogvce.me/images/UEFI-And-GPT/2.jpg"><meta property="og:image" content="http://blog.lyogvce.me/images/UEFI-And-GPT/3.jpg"><meta property="og:image" content="http://blog.lyogvce.me/images/UEFI-And-GPT/4.png"><meta property="og:image" content="http://blog.lyogvce.me/images/UEFI-And-GPT/5.png"><meta property="og:image" content="http://blog.lyogvce.me/images/UEFI-And-GPT/6.jpg"><meta property="og:image" content="http://blog.lyogvce.me/images/UEFI-And-GPT/7.jpg"><meta property="og:image" content="http://blog.lyogvce.me/images/UEFI-And-GPT/8.png"><meta property="og:image" content="http://blog.lyogvce.me/images/UEFI-And-GPT/9.png"><meta property="og:image" content="http://blog.lyogvce.me/images/UEFI-And-GPT/10.png"><meta property="og:image" content="http://blog.lyogvce.me/images/UEFI-And-GPT/11.png"><meta property="og:image" content="http://blog.lyogvce.me/images/UEFI-And-GPT/12.png"><meta property="og:image" content="http://blog.lyogvce.me/images/UEFI-And-GPT/13.png"><meta property="og:image" content="http://blog.lyogvce.me/images/UEFI-And-GPT/14.png"><meta property="og:image" content="http://blog.lyogvce.me/images/UEFI-And-GPT/15.png"><meta property="og:image" content="http://blog.lyogvce.me/images/UEFI-And-GPT/16.png"><meta property="og:image" content="http://blog.lyogvce.me/images/UEFI-And-GPT/17.png"><meta property="og:image" content="http://blog.lyogvce.me/images/UEFI-And-GPT/18.png"><meta property="og:image" content="http://blog.lyogvce.me/images/UEFI-And-GPT/19.png"><meta property="og:updated_time" content="2017-07-21T07:53:18.869Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="UEFI &amp; GPT"><meta name="twitter:description" content="1 引导基础篇: 什么是 UEFI, 什么是 GPT本文目的是想用最简单直白的语言把内容写出来, 让每个人都能轻松读懂。当然, 如果你已经对这些内容有了很深的理解的话, 这篇文章除了浪费你的时间外恐怕是别无益处了, 建议去 UEFI 官方网站下载 UEFI 规范文档, 那里详细阐述了 UEFI、GPT 的每个技术细节。"><meta name="twitter:image" content="http://blog.lyogvce.me/images/UEFI-And-GPT/MBR.jpg"><script id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Mist",sidebar:{position:"left",display:"post",offset:12,offset_float:0,b2t:!1,scrollpercent:!0,onmobile:!0},fancybox:!0,motion:!0,duoshuo:{userId:"0",author:"博主"},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><link rel="canonical" href="http://blog.lyogvce.me/2017-03/UEFI-And-GPT.html"><title>UEFI & GPT | Lyogvce</title><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?9769634a58e183d8dcae22cb614e6c88";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script></head><body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans"><div class="container sidebar-position-left page-post-detail"><div class="headband"></div><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">Lyogvce</span><span class="logo-line-after"><i></i></span></a></div><p class="site-subtitle">Lyogvce's 博客</p></div><div class="site-nav-toggle"><button><span class="btn-bar"></span><span class="btn-bar"></span><span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br>首页</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i><br>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br>归档</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br>标签</a></li><li class="menu-item menu-item-about"><a href="/about.html" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i><br>About Me</a></li><li class="menu-item menu-item-search"><a href="javascript:;" class="popup-trigger"><i class="menu-item-icon fa fa-search fa-fw"></i><br>搜索</a></li></ul><div class="site-search"><div class="popup search-popup local-search-popup"><div class="local-search-header clearfix"><span class="search-icon"><i class="fa fa-search"></i></span><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span><div class="local-search-input-wrapper"><input autocomplete="off" placeholder="搜索..." spellcheck="false" id="local-search-input"></div></div><div id="local-search-result"></div></div></div></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><link itemprop="mainEntityOfPage" href="http://blog.lyogvce.me/2017-03/UEFI-And-GPT.html"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="Lyogvce"><meta itemprop="description" content=""><meta itemprop="image" content="/avatar.svg"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Lyogvce"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">UEFI & GPT</h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-03-22T00:00:00+08:00">2017-03-22</time></span> <span class="post-category"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/计算机相关/" itemprop="url" rel="index"><span itemprop="name">计算机相关</span></a></span></span> <span id="/2017-03/UEFI-And-GPT.html" class="leancloud_visitors" data-flag-title="UEFI & GPT"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span> <span class="post-meta-item-text">阅读次数</span><span class="leancloud-visitors-count"></span></span><div class="post-wordcount"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i></span> <span class="post-meta-item-text">字数统计</span> <span title="字数统计">3,852</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-clock-o"></i></span> <span class="post-meta-item-text">阅读时长</span> <span title="阅读时长">14</span></div></div></header><div class="post-body" itemprop="articleBody"><h2 id="1-引导基础篇-什么是-UEFI-什么是-GPT"><a href="#1-引导基础篇-什么是-UEFI-什么是-GPT" class="headerlink" title="1 引导基础篇: 什么是 UEFI, 什么是 GPT"></a>1 引导基础篇: 什么是 UEFI, 什么是 GPT</h2><p>本文目的是想用最简单直白的语言把内容写出来, 让每个人都能轻松读懂。当然, 如果你已经对这些内容有了很深的理解的话, 这篇文章除了浪费你的时间外恐怕是别无益处了, 建议去 UEFI 官方网站下载 UEFI 规范文档, 那里详细阐述了 UEFI、GPT 的每个技术细节。</p><a id="more"></a><p>其实 UEFI、GPT 都不是什么新鲜玩意了, 只不过因为预装 Win8 电脑指定采用了这一标准所以仿佛是在一夜之间关于 UEFI 启动 Windows 的文章就遍地开花了, 很多人大概也是头一次听说世上还有这玩意。既然 UEFI、GPT 是 “新” 技术, 那么就必然有较旧技术 (BIOS+MBR) 更先进、更 NB 的地方。到底 NB 在哪里呢？下面来简单比较一下:</p><h3 id="GPT-及其优势"><a href="#GPT-及其优势" class="headerlink" title="GPT 及其优势"></a>GPT 及其优势</h3><p>GPT 和 MBR 是两种不同的分区方案。目前在 Windows 下广泛采用的磁盘分区方案仍然是 MBR 分区结构, 但不容怀疑 GPT 是今后的趋势。我们可将 MBR 磁盘分区结构用下图简单表示(Windows 下基本磁盘、4 个主分区):</p><p><img src="../images/UEFI-And-GPT/MBR.jpg" alt="MBR 分区结构">MBR 分区结构</p><p>为了方便计算机访问硬盘, 把硬盘上的空间划分成许许多多的区块(英文叫 sectors, 即扇区), 然后给每个区块分配一个地址, 称为逻辑块地址(即 LBA)。</p><p>在 MBR 磁盘的第一个扇区内保存着启动代码和硬盘分区表。启动代码的作用是指引计算机从活动分区引导启动操作系统 (BIOS 下启动操作系统的方式); 分区表的作用是记录硬盘的分区信息。在 MBR 中, 分区表的大小是固定的, 一共可容纳 4 个主分区信息。在 MBR 分区表中逻辑块地址采用 32 位二进制数表示, 因此一共可表示 2^32(2 的 32 次方) 个逻辑块地址。如果一个扇区大小为 512 字节, 那么硬盘最大分区容量仅为 2TB。</p><p>GPT 磁盘分区结构可用下图简单表示(Windows 下基本磁盘):</p><p><img src="../images/UEFI-And-GPT/gpt.jpg" alt="GPT 分区结构">GPT 分区结构</p><p>可以看到, 在 GTP 磁盘的第一个数据块中同样有一个与 MBR(主引导记录)类似的标记, 叫做 PMBR。PMBR 的作用是, 当使用不支持 GPT 的分区工具时, 整个硬盘将显示为一个受保护的分区, 以防止分区表及硬盘数据遭到破坏。UEFI 并不从 PMBR 中获取 GPT 磁盘的分区信息, 它有自己的分区表, 即 GPT 分区表。</p><p>GPT 的分区方案之所以比 MBR 更先进, 是因为在 GPT 分区表头中可自定义分区数量的最大值, 也就是说 GPT 分区表的大小不是固定的。在 Windows 中, 微软设定 GPT 磁盘最大分区数量为 128 个。另外, GPT 分区方案中逻辑块地址 (LBA) 采用 64 位二进制数表示, 可以计算一下 2^64 是一个多么庞大的数据, 以我们的需求来讲完全有理由认为这个大小约等于无限。除此之外, GPT 分区方案在硬盘的末端还有一个备份分区表, 保证了分区信息不容易丢失。</p><h3 id="Windows-操作系统对-GPT-磁盘的支持"><a href="#Windows-操作系统对-GPT-磁盘的支持" class="headerlink" title="Windows 操作系统对 GPT 磁盘的支持"></a>Windows 操作系统对 GPT 磁盘的支持</h3><p>因为 BIOS 无法识别 GPT 分区, 所以 BIOS 下 GPT 磁盘不能用于启动操作系统, 在操作系统提供支持的情况下可用于数据存储。</p><p>UEFI 可同时识别 MBR 分区和 GPT 分区, 因此 UEFI 下, MBR 磁盘和 GPT 磁盘都可用于启动操作系统和数据存储。不过微软限制, UEFI 下使用 Windows 安装程序安装操作系统是只能将系统安装在 GPT 磁盘中。</p><p>下表列出了 Windows 各版本操作系统对 GPT 磁盘的支持程度:</p><p><img src="../images/UEFI-And-GPT/1.jpg" alt="32 位 Windows 对 GPT 分区支持情况">32 位 Windows 对 GPT 分区支持情况</p><p><img src="../images/UEFI-And-GPT/2.jpg" alt="64 位 Windows 对 GPT 分区支持情况">64 位 Windows 对 GPT 分区支持情况</p><h3 id="UEFI-及其优势"><a href="#UEFI-及其优势" class="headerlink" title="UEFI 及其优势"></a>UEFI 及其优势</h3><p>UEFI 是 BIOS 的一种升级替代方案。关于 BIOS 和 UEFI 二者的比较, 网络上已经有很多相关的文章, 这里不再赘述, 仅从系统启动原理方面来做比较。UEFI 之所以比 BIOS 强大, 是因为 UEFI 本身已经相当于一个微型操作系统, 其带来的便利之处在于:</p><p><strong>首先,</strong> UEFI 已具备文件系统的支持, 它能够直接读取 FAT 分区中的文件;</p><blockquote><p>什么是文件系统？简单说, 文件系统是操作系统组织管理文件的一种方法, 直白点说就是把硬盘上的数据以文件的形式呈现给用户。Fat32、NTFS 都是常见的文件系统类型。</p></blockquote><p><strong>其次,</strong> 可开发出直接在 UEFI 下运行的应用程序, 这类程序文件通常以 efi 结尾。</p><p>既然 UEFI 可以直接识别 FAT 分区中的文件, 又有可直接在其中运行的应用程序。那么完全可以 <strong>将 Windows 安装程序做成 efi 类型应用程序, 然后把它放到任意 fat 分区中直接运行即可</strong>, 如此一来安装 Windows 操作系统这件过去看上去稍微有点复杂的事情突然就变非常简单了, 就像在 Windows 下打开 QQ 一样简单。而事实上, 也就是这么一回事。</p><p>要知道, 这些都是 BIOS 做不到的。因为 BIOS 下启动操作系统之前, 必须从硬盘上指定扇区读取系统启动代码 (包含在主引导记录中), 然后从活动分区中引导启动操作系统。对扇区的操作远比不上对分区中文件的操作更直观更简单, 所以在 BIOS 下引导安装 Windows 操作系统, 我们不得不使用一些工具对设备进行配置以达到启动要求。而在 UEFI 下, 这些统统都不需要, <strong>不再需要主引导记录, 不再需要活动分区, 不需要任何工具, 只要复制安装文件到一个 FAT32(主) 分区 / U 盘中, 然后从这个分区 / U 盘启动, 安装 Windows 就是这么简单</strong>。后面会有专门的文章来详细介绍 UEFI 下安装 Windows7、8 的方法。</p><h2 id="2-引导实践篇-一-切换到-UEFI-启动-准备安装介质"><a href="#2-引导实践篇-一-切换到-UEFI-启动-准备安装介质" class="headerlink" title="2 引导实践篇(一): 切换到 UEFI 启动, 准备安装介质"></a>2 引导实践篇(一): 切换到 UEFI 启动, 准备安装介质</h2><p>如果只单纯比较 UEFI 引导和 BIOS 引导, 那么毫无疑问 UEFI 引导要简单很多。不过现在的主板大都是同时兼容 BIOS 和 UEFI 引导方式, 所以在实际操作前还需要确认一些东西。详见下文。</p><h3 id="1、我的电脑支不支持-UEFI-启动？"><a href="#1、我的电脑支不支持-UEFI-启动？" class="headerlink" title="1、我的电脑支不支持 UEFI 启动？"></a>1、我的电脑支不支持 UEFI 启动？</h3><p>要通过 UEFI 方式启动 Windows7/8, 电脑需要支持 UEFI 启动。预装 Win8 的电脑都支持 UEFI 启动。近两年的主板很多也都支持 UEFI 启动。开机出现品牌标识按 F2(或者 DEL、ESC 等按键, 不通品牌按键不通)进入 BIOS/UEFI 设置, 在 Boot 项或类似项中查看有无 EFI/UEFI 相关选项, 如果有, 那么说明电脑支持 UEFI 启动。下图是联想 Y480UEFI 选项:</p><p><img src="../images/UEFI-And-GPT/3.jpg" alt="联想 Y480 UEFI 引导选项">联想 Y480 UEFI 引导选项</p><h3 id="2、想要-UEFI-启动-我该选择安装什么操作系统？"><a href="#2、想要-UEFI-启动-我该选择安装什么操作系统？" class="headerlink" title="2、想要 UEFI 启动, 我该选择安装什么操作系统？"></a>2、想要 UEFI 启动, 我该选择安装什么操作系统？</h3><p>目前几乎所有支持 UEFI 的个人电脑都是 64 位 UEFI 系统, 仅支持 64 位 Vista、64 位 Win7 以及 64 位 Win8/8.1。所以你只能从这几个操作系统中选择。切记, 只有原版镜像支持光盘 UEFI 启动, 一定要选择下载微软原版系统！<strong>建议选择的版本:</strong> 不管是 Win7、Win8 或 Win8.1, 都建议选择专业版; 激活都选择<a href="http://www.iruanmi.com/kmspico/" target="_blank" rel="external">KMS 激活方式</a>。</p><p><strong>提示:</strong> 已经下载了 Win7 旗舰版镜像的朋友, 如采用 U 盘安装或从硬盘引导安装(后面会讲到), 在准备好安装介质后只需要删除 sources 文件夹下面的 ei.cfg 文件即可选择安装除企业版之外任意版本, 包括专业版。</p><h3 id="3、预装-Win8-的电脑想要安装-64-位-Win7、Vista-需关闭安全启动-并开启-CSM"><a href="#3、预装-Win8-的电脑想要安装-64-位-Win7、Vista-需关闭安全启动-并开启-CSM" class="headerlink" title="3、预装 Win8 的电脑想要安装 64 位 Win7、Vista 需关闭安全启动, 并开启 CSM"></a>3、预装 Win8 的电脑想要安装 64 位 Win7、Vista 需关闭安全启动, 并开启 CSM</h3><p>具体选项:<br>① 某些预装 Win8 的电脑有名为 OS Optimized Defaults 的设置选项, 需要将这个选项设置为 Disabled。<br>② 找到类似 “Boot mode” 或者 “UEFI/Legacy Boot” 设置项, 将其设置为 “UEFI” 或类似选项。<br>③ 如果能找到 “Lunch CSM” 或类似选项, 将其设为 “Enabled”, 即开启状态。<br>④ 找到 “Secure Boot” 或类似选项, 将其设为 “Disabled”, 即关闭状态。不关闭安全启动, 无法安装 Win8 之外的操作系统。<br>详细教程: 《<a href="http://www.iruanmi.com/install-64bit-windows-7-on-a-pre-installed-win8-pc/" target="_blank" rel="external">预装 64 位 Win8/8.1 电脑安装 64 位 Win7 详细过程(单 / 双系统)</a>》</p><h3 id="4、-非安装双系统跳过此步-为将要安装的操作系统开辟新的分区"><a href="#4、-非安装双系统跳过此步-为将要安装的操作系统开辟新的分区" class="headerlink" title="4、(非安装双系统跳过此步)为将要安装的操作系统开辟新的分区"></a>4、(非安装双系统跳过此步)为将要安装的操作系统开辟新的分区</h3><p>如果想要在现有系统基础上再安装一个操作系统组成双系统, 首先你现有的系统必须为 UEFI+GPT 引导(例如, 预装 Win8 系统), 否则只能在安装过程中删除硬盘所有数据自动完成转换。<br>确定是否为 GPT 分区: 打开磁盘管理, 找到硬盘 0, 然后右键点击。如果有灰色选项 “转换成 MBR 磁盘” 则说明硬盘为 GPT 分区, 如下图①所示, 并且系统一定为 UEFI 引导。<br>开辟新分区的方法: 打开磁盘管理, 在剩余空间较大的分区上右键点击, 选择 “压缩”, 如下图 2 所示。然后输入合适的大小压缩即可(推荐不小于 50G)。</p><p><img src="../images/UEFI-And-GPT/4.png" alt="查看硬盘分区结构 &amp; 压缩分区空间">查看硬盘分区结构 &amp; 压缩分区空间</p><h3 id="5、准备安装介质"><a href="#5、准备安装介质" class="headerlink" title="5、准备安装介质"></a>5、准备安装介质</h3><p>有三种选择:</p><p>一、可以将微软原版 64 为 Win7 镜像、64 位 Win8 镜像直接刻入光盘, 从光盘启动安装。<br>二、可以准备一个容量不小于 4G 的 U 盘, 格式化为 FAT32, 然后复制 64 为 Win7 镜像或 64 位 Win8 镜像中的所有文件到 U 盘根目录, 文件结构如下图①所示。如果安装的是 64 位 Win7, 还需要下载 bootx64.efi 文件(<a href="http://pan.baidu.com/s/1qWDH6Ny" target="_blank" rel="external">点击下载</a>), 然后在 U 盘中 efi 文件夹下新建名为 boot 的文件夹, 把 bootx64.efi 文件放到里边。如下图②所示。<br><img src="../images/UEFI-And-GPT/5.png" alt="启动介质中文件结构"></p><p>启动介质中文件结构</p><p>三、也可以在电脑硬盘或者移动硬盘 (都必须为 GPT 分区) 任意位置压缩出一个分区(大小在 4G~30G 之间), 格式化为 FAT32, 然后参考上一条复制文件即可。</p><p><strong>特别提示:</strong> 如果下载的是 Win7 旗舰版, 想要安装专业版, 只需在准备好安装介质后删掉 sources 目录中的 ei.cfg 文件即可选择安装除企业版之外的任意版本, 包括专业版。</p><p>OK, 要准备的就这些。安装过程请参考《<a href="http://www.iruanmi.com/install-win7-or-win8-on-uefi-platform/" target="_blank" rel="external">UEFI+GPT 引导实践篇(二): UEFI 引导安装 64 位 Win7/Win8</a>》。</p><h2 id="3-UEFI-GPT-引导实践篇-二-UEFI-引导安装-64-位-Win7-Win8"><a href="#3-UEFI-GPT-引导实践篇-二-UEFI-引导安装-64-位-Win7-Win8" class="headerlink" title="3 UEFI+GPT 引导实践篇(二): UEFI 引导安装 64 位 Win7/Win8"></a>3 UEFI+GPT 引导实践篇(二): UEFI 引导安装 64 位 Win7/Win8</h2><p>下文是在联想 Y480 笔记本上以 UEFI 方式启动安装 Windows8 的全过程, 安装 Windows7 过程基本相同。注意, 如果你的电脑硬盘是 MBR 分区结构, 安装过程中将要删除硬盘上所有数据, 请安装前备份硬盘上的所有个人文件。</p><p><strong>准备容量不小于 4G 的 U 盘一个, 格式化为 FAT32。然后复制 64 位 Win8 镜像中的所有文件到 U 盘根目录。</strong> 注: 如果安装的是 64 位 Win7, 还需要下载 bootx64.efi 文件(<a href="http://pan.baidu.com/s/1qWDH6Ny" target="_blank" rel="external">点击下载</a>), 然后在 U 盘中 efi 文件夹下新建名为 boot 的文件夹, 把 bootx64.efi 文件放到里边。预装 Win8/8.1 电脑安装 Win7 还需要更改几个 BIOS 设置, 相关准备工作请参考《<a href="http://www.iruanmi.com/get-ready-for-installing/" target="_blank" rel="external">UEFI+GPT 引导准备篇: 切换到 UEFI 启动, 准备安装介质</a>》或参考专门针对此情况的完整教程《<a href="http://www.iruanmi.com/install-64bit-windows-7-on-a-pre-installed-win8-pc/" target="_blank" rel="external">预装 64 位 Win8/8.1 电脑安装 64 位 Win7 详细过程(单 / 双系统)</a>》。</p><p>重启电脑, 出现联想标识时按 F2 打开 BIOS 设置界面, 切换到 “boot” 设置界面将 UEFI Boot 设置项设置为 “Enable”, 这样就开启了 UEFI。按 F10 键, 保存设置。</p><p><img src="../images/UEFI-And-GPT/6.jpg" alt="1"></p><p>重启, 在出现联想标识时按 F12 键, 此时出现启动设备选择界面, 我们可以看到这里有两个 USB 设备。图中被选中的名称前面可以看到 “EFI” 字样, 这就表示该设备是可以 EFI 引导的设备。我们就需要选择这一项。</p><p><img src="../images/UEFI-And-GPT/7.jpg" alt="2"></p><p>选中图中的选项后, 电脑会开始加载 Windows 预安装环境文件。(注: 小编实际操作时安装的是 64 位 Win7, 但是手机拍下来的图很不清晰, 所以就在虚拟机中在 UEFI 模式下安装了 64 位 Win8, 二者无区别)</p><p><img src="../images/UEFI-And-GPT/8.png" alt="Windows 8-2013-06-08-20-09-47"></p><p>稍等出现下面的界面, 默认即可。</p><p><img src="../images/UEFI-And-GPT/9.png" alt="Windows 8-2013-06-08-20-10-56"></p><p>上图: 点下一步</p><p><img src="../images/UEFI-And-GPT/10.png" alt="Windows 8-2013-06-08-20-11-05"></p><p>上图: 点 “现在安装”</p><p><img src="../images/UEFI-And-GPT/11.png" alt="Windows 8-2013-06-08-20-11-15"></p><p><img src="../images/UEFI-And-GPT/12.png" alt="Windows 8-2013-06-08-20-12-20"></p><p><img src="../images/UEFI-And-GPT/13.png" alt="Windows 8-2013-06-08-20-12-38"></p><p><img src="../images/UEFI-And-GPT/14.png" alt="Windows 8-2013-06-08-20-12-45"></p><p>上图: 这里选择 “自定义”, 进入分区选择界面。如果你的电脑硬盘已经为 GPT 分区结构, 那么直接选择目标分区, 将其格式化, 然后选中点下一步即可。下面是硬盘位 MBR 分区结构的情况:</p><p><img src="../images/UEFI-And-GPT/15.png" alt="Windows 8-2013-06-08-20-13-39"></p><p>上图: 如果你的电脑硬盘为 MBR 分区结构, 那么会看到 “无法在驱动器 X 的分区 x 上安装 Windows” 的提示, 这时候需要点击 “驱动器选项(高级)”, 然后删除硬盘上所有的分区使得整个硬盘变成一块未分配空间。提示: 在这一步你也可以按 Shift+F10 或者 Shift+Fn+F10 调出命令提示符窗口, 然后借助 diskpart 工具将硬盘转换为 GPT 分区。命令详见《<a href="http://www.iruanmi.com/convert-gpt-to-mbr-or-convert-mbr-to-gpt-use-diskpart-tool/" target="_blank" rel="external">Diskpart 工具应用两则: MBR/GPT 分区转换 &amp; 基本 / 动态磁盘转换</a>》。</p><p><img src="../images/UEFI-And-GPT/16.png" alt="Windows 8-2013-06-08-20-19-11"></p><p>上图: 整个硬盘已成为一块未分配空间。点击 “新建”, 输入想要为系统安装分区分配的空间大小(推荐不小于 50G), 点击 “应用”。</p><p><img src="../images/UEFI-And-GPT/17.png" alt="Windows 8-2013-06-08-20-19-27"></p><p>上图: 此时提示将创建额外的分区, 点击 “确定”。之后安装程序会自动将硬盘转换为 GPT 分区。创建完成后你将看到四个创建好的分区, 如下图所示。关于这些分区的作用详见《<a href="http://www.iruanmi.com/win8-oem-devices-disk-partition-analysis/" target="_blank" rel="external">用于引导 Windows 的 GPT 磁盘 (预装 Win8 电脑) 各分区作用详解</a>》</p><p><img src="../images/UEFI-And-GPT/18.png" alt="Windows 8-2013-06-08-20-20-06"></p><p>选择第一个主分区, 然后点 “下一步” 就开始安装了。之后根据提示操作即可完成系统安装。</p><p><img src="../images/UEFI-And-GPT/19.png" alt="Windows 8-2013-06-08-20-20-13"></p><h3 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h3><p>实际上只有遵循 UEFI 规范的主板才能按照 efi/boot/bootx64.efi 路径启动 Windows 安装程序, 大多数主板都是遵循这一规范的。如果不遵循这一规范, 那么你需要手动选择从该文件启动, 或者需要在 UEFI Shell 中以命令的方式启动 bootx64.efi。关于这些后面会有文章来详解。另外关于预装 Win8 电脑改装 Win7 或者安装 Win8+Win7 双系统都会有专门教程。</p><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p>整理自:<br><a href="http://www.iruanmi.com/what-is-gpt-and-what-is-uefi/" target="_blank" rel="external">http://www.iruanmi.com/what-is-gpt-and-what-is-uefi/</a><br><a href="http://www.iruanmi.com/get-ready-for-installing/" target="_blank" rel="external">http://www.iruanmi.com/get-ready-for-installing/</a><br><a href="http://www.iruanmi.com/install-win7-or-win8-on-uefi-platform/" target="_blank" rel="external">http://www.iruanmi.com/install-win7-or-win8-on-uefi-platform/</a></p></div><div></div><div><div style="padding:10px 0;margin:20px auto;width:90%;text-align:center"><div>坚持原创技术分享，您的支持将鼓励我继续创作！</div><button id="rewardButton" disable="enable" onclick='var qr=document.getElementById("QR");"none"===qr.style.display?qr.style.display="block":qr.style.display="none"'><span>赏</span></button><div id="QR" style="display:none"><div id="wechat" style="display:inline-block"><img id="wechat_qr" src="../images/wechat-reward.png" alt="Lyogvce WeChat Pay"><p>微信打赏</p></div><div id="alipay" style="display:inline-block"><img id="alipay_qr" src="../images/alipay-reward.jpg" alt="Lyogvce Alipay"><p>支付宝打赏</p></div></div></div></div><div><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者：</strong> Lyogvce</li><li class="post-copyright-link"><strong>本文链接：</strong> <a href="http://blog.lyogvce.me/2017-03/UEFI-And-GPT.html" title="UEFI & GPT">http://blog.lyogvce.me/2017-03/UEFI-And-GPT.html</a></li><li class="post-copyright-license"><strong>版权声明：</strong> 本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/" rel="external nofollow" target="_blank">CC BY-NC-SA 3.0</a> 许可协议。转载请注明出处！</li></ul></div><footer class="post-footer"><div class="post-tags"><a href="/tags/装机/" rel="tag"># 装机</a></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/2017-01/Enable-Epel-Repo-For-RHEL-And-CentOS.html" rel="next" title="如何为 RHEL / CentOS 7.x / 6.x / 5.x 启用 EPEL 存储库"><i class="fa fa-chevron-left"></i> 如何为 RHEL / CentOS 7.x / 6.x / 5.x 启用 EPEL 存储库</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"><a href="/2017-03/System-Repair-Command-Of-Windows.html" rel="prev" title="一些常用的修复 Windows 系统的命令行及使用教程">一些常用的修复 Windows 系统的命令行及使用教程<i class="fa fa-chevron-right"></i></a></div></div></footer></article><div class="post-spread"><div class="bdsharebuttonbox"><a href="#" class="bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a><a href="#" class="bds_douban" data-cmd="douban" title="分享到豆瓣网"></a><a href="#" class="bds_sqq" data-cmd="sqq" title="分享到QQ好友"></a><a href="#" class="bds_qzone" data-cmd="qzone" title="分享到QQ空间"></a><a href="#" class="bds_weixin" data-cmd="weixin" title="分享到微信"></a><a href="#" class="bds_tieba" data-cmd="tieba" title="分享到百度贴吧"></a><a href="#" class="bds_twi" data-cmd="twi" title="分享到Twitter"></a><a href="#" class="bds_fbook" data-cmd="fbook" title="分享到Facebook"></a><a href="#" class="bds_more" data-cmd="more"></a><a class="bds_count" data-cmd="count"></a></div><script>window._bd_share_config={common:{bdText:"",bdMini:"2",bdMiniList:!1,bdPic:""},share:{bdSize:"16",bdStyle:"0"},image:{viewList:["tsina","douban","sqq","qzone","weixin","twi","fbook"],viewText:"分享到：",viewSize:"16"}}</script><script>with(document)(getElementsByTagName("head")[0]||body).appendChild(createElement("script")).src="//bdimg.share.baidu.com/static/api/js/share.js?cdnversion="+~(-new Date/36e5)</script></div></div></div><div class="comments" id="comments"><div id="lv-container" data-id="city" data-uid="MTAyMC8yOTM1NC81OTIy"></div></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span><span class="sidebar-toggle-line sidebar-toggle-line-middle"></span><span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div id="sidebar-dimmer"></div><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">文章目录</li><li class="sidebar-nav-overview" data-target="site-overview">站点概览</li></ul><section class="site-overview sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" src="/avatar.svg" alt="Lyogvce"><p class="site-author-name" itemprop="name">Lyogvce</p><p class="site-description motion-element" itemprop="description">应届狗求 Offer</p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">20</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/index.html"><span class="site-state-item-count">16</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/index.html"><span class="site-state-item-count">21</span> <span class="site-state-item-name">标签</span></a></div></nav><div class="feed-link motion-element"><a href="/atom.xml" rel="alternate"><i class="fa fa-rss"></i> RSS</a></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/Will-Grindelwald" target="_blank" title="GitHub"><i class="fa fa-fw fa-github"></i> GitHub</a></span></div><div class="links-of-blogroll motion-element links-of-blogroll-inline"><div class="links-of-blogroll-title"><i class="fa fa-fw fa-globe"></i> Links</div><ul class="links-of-blogroll-list"><li class="links-of-blogroll-item"><a href="http://www.lyogvce.me/" title="我的主页" target="_blank">我的主页</a></li></ul></div></section><section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-引导基础篇-什么是-UEFI-什么是-GPT"><span class="nav-text">1 引导基础篇: 什么是 UEFI, 什么是 GPT</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#GPT-及其优势"><span class="nav-text">GPT 及其优势</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Windows-操作系统对-GPT-磁盘的支持"><span class="nav-text">Windows 操作系统对 GPT 磁盘的支持</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#UEFI-及其优势"><span class="nav-text">UEFI 及其优势</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-引导实践篇-一-切换到-UEFI-启动-准备安装介质"><span class="nav-text">2 引导实践篇(一): 切换到 UEFI 启动, 准备安装介质</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1、我的电脑支不支持-UEFI-启动？"><span class="nav-text">1、我的电脑支不支持 UEFI 启动？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2、想要-UEFI-启动-我该选择安装什么操作系统？"><span class="nav-text">2、想要 UEFI 启动, 我该选择安装什么操作系统？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3、预装-Win8-的电脑想要安装-64-位-Win7、Vista-需关闭安全启动-并开启-CSM"><span class="nav-text">3、预装 Win8 的电脑想要安装 64 位 Win7、Vista 需关闭安全启动, 并开启 CSM</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4、-非安装双系统跳过此步-为将要安装的操作系统开辟新的分区"><span class="nav-text">4、(非安装双系统跳过此步)为将要安装的操作系统开辟新的分区</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5、准备安装介质"><span class="nav-text">5、准备安装介质</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-UEFI-GPT-引导实践篇-二-UEFI-引导安装-64-位-Win7-Win8"><span class="nav-text">3 UEFI+GPT 引导实践篇(二): UEFI 引导安装 64 位 Win7/Win8</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#后记"><span class="nav-text">后记</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#参考"><span class="nav-text">参考</span></a></li></ol></div></div></section></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><div class="copyright">&copy; 2016 - <span itemprop="copyrightYear">2017</span><span class="with-love"><i class="fa fa-heart"></i></span> <span class="author" itemprop="copyrightHolder">Lyogvce</span></div><div class="busuanzi-count"><script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="site-uv"><span id="visit" title="本站访客数"><i class="fa fa-user"></i><span class="busuanzi-value" id="busuanzi_value_site_uv"></span></span></span><span class="site-pv"><span id="visit" title="本站总访问量"><i class="fa fa-eye"></i><span class="busuanzi-value" id="busuanzi_value_site_pv"></span></span></span></div></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span id="scrollpercent"><span>0</span>%</span></div></div><script>"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script src="/lib/jquery/index.js?v=2.1.3"></script><script src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script><script src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script><script src="/js/src/utils.js?v=5.1.1"></script><script src="/js/src/motion.js?v=5.1.1"></script><script src="/js/src/scrollspy.js?v=5.1.1"></script><script src="/js/src/post-details.js?v=5.1.1"></script><script src="/js/src/bootstrap.js?v=5.1.1"></script><script>!function(e,t){var n,c=e.getElementsByTagName(t)[0];"function"!=typeof LivereTower&&((n=e.createElement(t)).src="https://cdn-city.livere.com/js/embed.dist.js",n.async=!0,c.parentNode.insertBefore(n,c))}(document,"script")</script><script>function proceedsearch(){$("body").append('<div class="search-popup-overlay local-search-pop-overlay"></div>').css("overflow","hidden"),$(".search-popup-overlay").click(onPopupClose),$(".popup").toggle();var t=$("#local-search-input");t.attr("autocapitalize","none"),t.attr("autocorrect","off"),t.focus()}var isfetched=!1,isXml=!0,search_path="search.xml";0===search_path.length?search_path="search.xml":/json$/i.test(search_path)&&(isXml=!1);var path="/"+search_path,onPopupClose=function(t){$(".popup").hide(),$("#local-search-input").val(""),$(".search-result-list").remove(),$("#no-result").remove(),$(".local-search-pop-overlay").remove(),$("body").css("overflow","")},searchFunc=function(t,e,o){"use strict";$("body").append('<div class="search-popup-overlay local-search-pop-overlay"><div id="search-loading-icon"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div>').css("overflow","hidden"),$("#search-loading-icon").css("margin","20% auto 0 auto").css("text-align","center"),$.ajax({url:t,dataType:isXml?"xml":"json",async:!0,success:function(t){isfetched=!0,$(".popup").detach().appendTo(".header-inner");var n=isXml?$("entry",t).map(function(){return{title:$("title",this).text(),content:$("content",this).text(),url:$("url",this).text()}}).get():t,r=document.getElementById(e),s=document.getElementById(o),a=function(){var t=r.value.trim().toLowerCase(),e=t.split(/[\s\-]+/);e.length>1&&e.push(t);var o=[];if(t.length>0&&n.forEach(function(n){var r=!1,s=0,a=0,i=n.title.trim(),c=i.toLowerCase(),l=n.content.trim().replace(/<[^>]+>/g,""),h=l.toLowerCase(),p=decodeURIComponent(n.url),u=[],f=[];if(""!=i&&(e.forEach(function(t){function e(t,e,o){var n=t.length;if(0===n)return[];var r=0,s=[],a=[];for(o||(e=e.toLowerCase(),t=t.toLowerCase());(s=e.indexOf(t,r))>-1;)a.push({position:s,word:t}),r=s+n;return a}u=u.concat(e(t,c,!1)),f=f.concat(e(t,h,!1))}),(u.length>0||f.length>0)&&(r=!0,s=u.length+f.length)),r){[u,f].forEach(function(t){t.sort(function(t,e){return e.position!==t.position?e.position-t.position:t.word.length-e.word.length})});function d(e,o,n,r){for(var s=r[r.length-1],i=s.position,c=s.word,l=[],h=0;i+c.length<=n&&0!=r.length;){c===t&&h++,l.push({position:i,length:c.length});var p=i+c.length;for(r.pop();0!=r.length&&(s=r[r.length-1],i=s.position,c=s.word,p>i);)r.pop()}return a+=h,{hits:l,start:o,end:n,searchTextCount:h}}var g=[];0!=u.length&&g.push(d(0,0,i.length,u));for(var v=[];0!=f.length;){var $=f[f.length-1],C=$.position,m=$.word,x=C-20,w=C+80;x<0&&(x=0),w<C+m.length&&(w=C+m.length),w>l.length&&(w=l.length),v.push(d(0,x,w,f))}v.sort(function(t,e){return t.searchTextCount!==e.searchTextCount?e.searchTextCount-t.searchTextCount:t.hits.length!==e.hits.length?e.hits.length-t.hits.length:t.start-e.start});var y=parseInt("-1");y>=0&&(v=v.slice(0,y));function T(t,e){var o="",n=e.start;return e.hits.forEach(function(e){o+=t.substring(n,e.position);var r=e.position+e.length;o+='<b class="search-keyword">'+t.substring(e.position,r)+"</b>",n=r}),o+=t.substring(n,e.end)}var b="";0!=g.length?b+="<li><a href='"+p+"' class='search-result-title'>"+T(i,g[0])+"</a>":b+="<li><a href='"+p+"' class='search-result-title'>"+i+"</a>",v.forEach(function(t){b+="<a href='"+p+'\'><p class="search-result">'+T(l,t)+"...</p></a>"}),b+="</li>",o.push({item:b,searchTextCount:a,hitCount:s,id:o.length})}}),1===e.length&&""===e[0])s.innerHTML='<div id="no-result"><i class="fa fa-search fa-5x" /></div>';else if(0===o.length)s.innerHTML='<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>';else{o.sort(function(t,e){return t.searchTextCount!==e.searchTextCount?e.searchTextCount-t.searchTextCount:t.hitCount!==e.hitCount?e.hitCount-t.hitCount:e.id-t.id});var a='<ul class="search-result-list">';o.forEach(function(t){a+=t.item}),a+="</ul>",s.innerHTML=a}};r.addEventListener("input",a),$(".local-search-pop-overlay").remove(),$("body").css("overflow",""),proceedsearch()}})};$(".popup-trigger").click(function(t){t.stopPropagation(),!1===isfetched?searchFunc(path,"local-search-input","local-search-result"):proceedsearch()}),$(".popup-btn-close").click(onPopupClose),$(".popup").click(function(t){t.stopPropagation()}),$(document).on("keyup",function(t){27===t.which&&$(".search-popup").is(":visible")&&onPopupClose()})</script><script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script><script>AV.initialize("C1Wj889AvDDOBNOisIhWiTUT-gzGzoHsz","bPVDK5wvDlz91eBKeiaKByiO")</script><script>function showTime(e){var t=new AV.Query(e),n=[],o=$(".leancloud_visitors");o.each(function(){n.push($(this).attr("id").trim())}),t.containedIn("url",n),t.find().done(function(e){if(0!==e.length){for(c=0;c<e.length;c++){var t=e[c],i=t.get("url"),s=t.get("time"),l=document.getElementById(i);$(l).find(".leancloud-visitors-count").text(s)}for(var c=0;c<n.length;c++){var i=n[c],l=document.getElementById(i),r=$(l).find(".leancloud-visitors-count");""==r.text()&&r.text(0)}}else o.find(".leancloud-visitors-count").text(0)}).fail(function(e,t){console.log("Error: "+t.code+" "+t.message)})}function addCount(e){var t=$(".leancloud_visitors"),n=t.attr("id").trim(),o=t.attr("data-flag-title").trim(),i=new AV.Query(e);i.equalTo("url",n),i.find({success:function(t){if(t.length>0){var i=t[0];i.fetchWhenSave(!0),i.increment("time"),i.save(null,{success:function(e){$(document.getElementById(n)).find(".leancloud-visitors-count").text(e.get("time"))},error:function(e,t){console.log("Failed to save Visitor num, with error message: "+t.message)}})}else{var s=new e,l=new AV.ACL;l.setPublicReadAccess(!0),l.setPublicWriteAccess(!0),s.setACL(l),s.set("title",o),s.set("url",n),s.set("time",1),s.save(null,{success:function(e){$(document.getElementById(n)).find(".leancloud-visitors-count").text(e.get("time"))},error:function(e,t){console.log("Failed to create")}})}},error:function(e){console.log("Error:"+e.code+" "+e.message)}})}$(function(){var e=AV.Object.extend("Counter");1==$(".leancloud_visitors").length?addCount(e):$(".post-title-link").length>1&&showTime(e)})</script><script>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(t,s)}()</script></body></html>